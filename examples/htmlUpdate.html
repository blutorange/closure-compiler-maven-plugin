<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 2.0.0 from src/site/markdown/examples/htmlUpdate.md at 2025-03-02
 | Rendered using Apache Maven Fluido Skin 2.0.0-M10
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 2.0.0" />
    <title>Updating HTML pages â€“ Closure Compiler Maven Plugin</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-2.0.0-M10.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />
    <script src="../js/apache-maven-fluido-2.0.0-M10.min.js"></script>
  </head>
  <body>
    <a class="github-fork-ribbon right-top" href="https://github.com/blutorange/closure-compiler-maven-plugin" data-ribbon="Fork me on GitHub">Fork me on GitHub</a>
    <div class="container-fluid container-fluid-top">
      <header>
        <div id="banner">
          <div class="pull-left"></div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
      <li><a href=".././">Minify Maven Plugin</a><span class="divider">/</span></li>
    <li class="active">Updating HTML pages</li>
        <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2025-03-02</li>
          <li id="projectVersion" class="pull-right"><span class="divider">|</span>Version: 2.32.0</li>
        <li class="pull-right"><span class="divider">|</span>
<a href="https://maven.apache.org" class="externalLink">Maven</a></li>
        <li class="pull-right"><a href="http://www.apache.org" class="externalLink">Apache</a></li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span3">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Overview</li>
    <li><a href="../index.html">Introduction</a></li>
    <li><a href="../plugin-info.html">Goals</a></li>
    <li><a href="../usage.html">Usage</a></li>
    <li><a href="../faq.html">FAQ</a></li>
   <li class="nav-header">Examples</li>
    <li><a href="../examples/basic.html">Basic Configuration</a></li>
    <li><a href="../examples/patterns.html">Using include/exclude patterns</a></li>
    <li><a href="../examples/bundle.html">Bundle Configuration</a></li>
    <li><a href="../examples/exclude.html">Exclude source files from WAR package</a></li>
    <li><a href="../examples/m2e.html">Eclipse m2e maven integration</a></li>
    <li><a href="../examples/watch.html">Watching for file changes</a></li>
    <li class="active"><a>Updating HTML files</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="../project-info.html"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="../project-reports.html"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
<a href="https://maven.apache.org/" class="builtBy" target="_blank"><img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn" class="span9">
<section><a id="Updating_HTML_pages"></a>
<h1>Updating HTML pages</h1>
<p>Available since version 2.32.0.</p>
<p>You can update an HTML file with the path of the generated output script file. Supports HTML as well as XML and XHTML
files. To update an HTML file, use the <code>&lt;htmlUpdates&gt;&lt;/htmlUpdates&gt;</code> option. Below is a description of the various
options.</p>
<ul>

<li>For a discussion  regarding this feature, see also <a href="https://github.com/blutorange/closure-compiler-maven-plugin/issues/4" class="externalLink">issue 4</a>.</li>
<li>For a longer description of each option, see the JavaDocs of
<a href="../apidocs/com/github/blutorange/maven/plugin/closurecompiler/plugin/HtmlUpdate.html">HtmlUpdate</a></li>
<li>For more examples, see also the
<a href="https://github.com/blutorange/closure-compiler-maven-plugin/tree/master/src/test/resources/projects/htmlUpdate" class="externalLink">tests for this feature</a></li>
</ul>
<p>In order for this plugin to be able to update a script tag in an HTML file, 3 main questions need to be answered:</p>
<ol style="list-style-type: decimal;">

<li>Which HTML files should be updated?</li>
<li>How to locate the script element to update?</li>
<li>How to construct the relative path from the HTML file to the script file?</li>
</ol><section><a id="Configuring_the_HTML_files_to_update"></a>
<h2>Configuring the HTML files to update</h2>
<p>First, we need to find the HTML files that should be processed.</p>
<p>To find the HTML file or files to update, this plugin uses Maven's standard includes/excludes approach. By default,
all HTML files are included.</p>
<p>You also need to specify a base directory to scan for HTML files. Similarly to the configuration for minifying files,
this plugin offers a <code>baseHtmlDir</code> and an <code>htmlDir</code> option. This way, you can configure a default base directory for all
executions. In addition, you can also set a separate <code>dir</code> for each <code>htmlUpdate</code>.</p>
<p>Note that not all of these options are required. For example, you could only set <code>baseHtmlDir</code>, or only a <code>dir</code>
for each <code>htmlUpdate</code>. If multiple options are given, they are resolved relative to each other.</p>

<pre class="prettyprint"><code class="language-xml">&lt;project&gt;
  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;com.github.blutorange&lt;/groupId&gt;
        &lt;artifactId&gt;closure-compiler-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;${closure-compiler-maven-plugin.version}&lt;/version&gt;
        &lt;configuration&gt;
           &lt;!-- Defaults to src/main/resources --&gt;
          &lt;baseHtmlDir&gt;${project.basedir}/web&lt;/baseHtmlDir&gt;
        &lt;/configuration&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;id&gt;default-minify&lt;/id&gt;
            &lt;goals&gt;&lt;goal&gt;minify&lt;/goal&gt;&lt;/goals&gt;
            &lt;configuration&gt;
              &lt;!-- Resolves to ${project.basedir}/web/templates --&gt;
              &lt;htmlDir&gt;templates&lt;/htmlDir&gt;
              &lt;htmlUpdates&gt;
                &lt;htmlUpdate&gt;
                  &lt;!-- Resolves to ${project.basedir}/web/templates/page1 --&gt;
                  &lt;dir&gt;page1&lt;/dir&gt;      
                &lt;/htmlUpdate&gt;
                &lt;htmlUpdate&gt;
                  &lt;!-- Resolves to ${project.basedir}/web/templates/page2 --&gt;
                  &lt;dir&gt;page2&lt;/dir&gt;
                &lt;/htmlUpdate&gt;
              &lt;/htmlUpdates&gt;
            &lt;/configuration&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
&lt;/project&gt;
</code></pre>
<p>The default encoding is <code>UTF-8</code>. If the HTML file uses a different encoding, use the <code>encoding</code> option:</p>

<pre class="prettyprint"><code class="language-xml">&lt;htmlUpdates&gt;
  &lt;htmlUpdate&gt;
    &lt;encoding&gt;UTF16-BE&lt;/encoding&gt;
  &lt;/htmlUpdate&gt;
&lt;/htmlUpdates&gt;
</code></pre></section><section><a id="Locating_the_script_elements_to_update"></a>
<h2>Locating the script elements to update</h2>
<p>Next, we need to locate the script element.</p>
<p>To find the script element to update, you need to specify a selector that can be used to locate the element. For
flexibility, this plugin offers 3 different types of selectors: by ID, by CSS selector, or by XPath. By default, the
first <code>&lt;script&gt;</code> element in the HTML file is used. If a selector matches multiple elements, all matching elements are
updated.</p>
<p>For example:</p>

<pre class="prettyprint"><code class="language-xml">&lt;project&gt;
  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;com.github.blutorange&lt;/groupId&gt;
        &lt;artifactId&gt;closure-compiler-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;${closure-compiler-maven-plugin.version}&lt;/version&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;id&gt;default-minify&lt;/id&gt;
            &lt;goals&gt;&lt;goal&gt;minify&lt;/goal&gt;&lt;/goals&gt;
            &lt;configuration&gt;
              &lt;htmlDir&gt;templates&lt;/htmlDir&gt;
              &lt;htmlUpdates&gt;
                &lt;htmlUpdate&gt;
                  &lt;scripts&gt;id:target&lt;/scripts&gt;
                &lt;/htmlUpdate&gt;
                &lt;htmlUpdate&gt;
                  &lt;scripts&gt;css:.my-script[type='module']&lt;/scripts&gt;
                &lt;/htmlUpdate&gt;
                &lt;htmlUpdate&gt;
                  &lt;scripts&gt;xpath://script[contains(text(), &quot;code&quot;)]&lt;/scripts&gt;
                &lt;/htmlUpdate&gt;
              &lt;/htmlUpdates&gt;
            &lt;/configuration&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
&lt;/project&gt;
</code></pre>
<p>By default, the <code>src</code> attribute of the matching elements are updated to the new value. For advanced use cases, you
can use the <code>attributes</code> option to update different or additional attributes:</p>

<pre class="prettyprint"><code class="language-xml">&lt;htmlUpdates&gt;
  &lt;htmlUpdate&gt;
    &lt;attributes&gt;
        &lt;attribute&gt;src&lt;/attribute&gt;
        &lt;attribute&gt;data-src&lt;/attribute&gt;
    &lt;/attributes&gt;
  &lt;/htmlUpdate&gt;
&lt;/htmlUpdates&gt;
</code></pre></section><section><a id="Constructing_the_relative_path_from_the_HTML_to_the_script_file"></a>
<h2>Constructing the relative path from the HTML to the script file</h2>
<p>Finally, we need to create a relative path from the HTML file to the script file.</p>
<p>The easiest way to do so would be relativizing the path of the script file on the file system against the path of
the HTML file. However, in many cases, the physical location will not correspond to the final location when the files
are served by a server.</p>
<p>To offer enough flexibility for such use cases, this plugin lets you define the root path for HTML and script file. The
physical location of the HTML and script file is then resoled against the respective root path. Lastly, the relative
path of the script file gets relativized against the relative path of the HTML file.</p>
<p>For example, assume the following configuration:</p>
<ul>

<li>HTML file - <code>/home/user/project/src/main/resources/webapp/public/pages/profile/index.html</code></li>
<li>Script file - <code>/home/user/project/target/generated-resources/frontend/js/public/resources/main/script.min.js</code></li>
<li>HTML root - <code>/home/user/project/src/main/resources/webapp</code></li>
<li>Script root - <code>/home/user/project/target/generated-resources/frontend/js</code></li>
</ul>
<p>Then, the relative path of the HTML file relative to the HTML root is <code>public/pages/profile/index.html</code>
and the relative of the JavaScript file is <code>public/resources/main/script.min.js</code>. Relativizing the script file against
the HTML file yields <code>../../resources/main/script.min.js</code>, which is used to update the <code>&lt;script&gt;</code> tag.</p>
<p>Similarly to the configuration for minifying files, this plugin offers the <code>baseHtmlRoot</code> / <code>baseHtmlScriptRoot</code> options
in addition to the <code>htmlRoot</code> and <code>htmlScriptRoot</code> options. This way, you can configure a default base directory for all
executions. In addition, you can also set a separate <code>root</code> and <code>scriptRoot</code> for each <code>htmlUpdate</code>.</p>

<pre class="prettyprint"><code class="language-xml">&lt;project&gt;
  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;com.github.blutorange&lt;/groupId&gt;
        &lt;artifactId&gt;closure-compiler-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;${closure-compiler-maven-plugin.version}&lt;/version&gt;
        &lt;configuration&gt;
          &lt;!-- Defaults to src/main/resources --&gt;
          &lt;baseHtmlRoot&gt;${project.basedir}/web/html&lt;/baseHtmlRoot&gt;
          &lt;!-- Defaults to target/generated-resources --&gt;
          &lt;baseHtmlScriptRoot&gt;${project.basedir}/web/js&lt;/baseHtmlScriptRoot&gt;
        &lt;/configuration&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;id&gt;default-minify&lt;/id&gt;
            &lt;goals&gt;&lt;goal&gt;minify&lt;/goal&gt;&lt;/goals&gt;
            &lt;configuration&gt;
              &lt;!-- Resolves to ${project.basedir}/web/html/area/blog --&gt;
              &lt;htmlRoot&gt;area/blog&lt;/htmlRoot&gt;
              &lt;!-- Resolves to ${project.basedir}/web/js/area/blog --&gt;
              &lt;htmlScriptRoot&gt;area/blog&lt;/htmlScriptRoot&gt;
              &lt;htmlUpdates&gt;
                &lt;htmlUpdate&gt;
                  &lt;!-- Resolves to ${project.basedir}/web/html/area/blog/articles --&gt;
                  &lt;root&gt;articles&lt;/root&gt;
                  &lt;!-- Resolves to ${project.basedir}/web/js/area/blog/articles --&gt;
                  &lt;scriptRoot&gt;articles&lt;/scriptRoot&gt;
                &lt;/htmlUpdate&gt;
                &lt;htmlUpdate&gt;
                  &lt;!-- Resolves to ${project.basedir}/web/html/area/blog/extras --&gt;
                  &lt;root&gt;extras&lt;/root&gt;
                  &lt;!-- Resolves to ${project.basedir}/web/js/area/blog/extras --&gt;
                  &lt;scriptRoot&gt;extras&lt;/scriptRoot&gt;
                &lt;/htmlUpdate&gt;
              &lt;/htmlUpdates&gt;
            &lt;/configuration&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
&lt;/project&gt;
</code></pre>
<p>In case you want to relativize the files with respect to their physical location on the file system, set the
<code>&lt;usePhysicalRoot&gt;</code> option to true, either in the top-level plugin configuration or inside an <code>&lt;htmlUpdate&gt;</code> tag:</p>

<pre class="prettyprint"><code class="language-xml">&lt;project&gt;
  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;com.github.blutorange&lt;/groupId&gt;
        &lt;artifactId&gt;closure-compiler-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;${closure-compiler-maven-plugin.version}&lt;/version&gt;
        &lt;configuration&gt;
        &lt;/configuration&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;id&gt;default-minify&lt;/id&gt;
            &lt;goals&gt;&lt;goal&gt;minify&lt;/goal&gt;&lt;/goals&gt;
            &lt;htmlUsePhysicalRoot&gt;true&lt;/htmlUsePhysicalRoot&gt;
            &lt;configuration&gt;
              &lt;htmlUpdates&gt;
                &lt;htmlUpdate&gt;
                 &lt;!-- Overrides the htmlUsePhysicalRoot --&gt;
                  &lt;usePhysicalRoot&gt;true&lt;/usePhysicalRoot&gt;
                &lt;/htmlUpdate&gt;
              &lt;/htmlUpdates&gt;
            &lt;/configuration&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
&lt;/project&gt;
</code></pre>
<p>In case the above does not suit your needs, you can also specify the source path directly via the <code>sourcePath</code> option,
either in the top-level plugin configuration or inside an <code>&lt;htmlUpdate&gt;</code> tag:</p>

<pre class="prettyprint"><code class="language-xml">&lt;project&gt;
  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;com.github.blutorange&lt;/groupId&gt;
        &lt;artifactId&gt;closure-compiler-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;${closure-compiler-maven-plugin.version}&lt;/version&gt;
        &lt;configuration&gt;
        &lt;/configuration&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;id&gt;default-minify&lt;/id&gt;
            &lt;goals&gt;&lt;goal&gt;minify&lt;/goal&gt;&lt;/goals&gt;
            &lt;htmlSourcePath&gt;../../#{basename}.#{extension}&lt;/htmlSourcePath&gt;
            &lt;configuration&gt;
              &lt;htmlUpdates&gt;
                &lt;htmlUpdate&gt;
                  &lt;!-- Overrides the htmlSourcePath --&gt;
                  &lt;sourcePath&gt;../../#{basename}.#{extension}&lt;/sourcePath&gt;
                &lt;/htmlUpdate&gt;
              &lt;/htmlUpdates&gt;
            &lt;/configuration&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
&lt;/project&gt;
</code></pre></section></section>        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Â©      2009â€“2025
<a href="http://github.com/blutorange">Andre Wachsmuth</a>
</p>
        </div>
      </div>
    </footer>
  </body>
</html>